package org.mend.io;

import com.fasterxml.jackson.annotation.JsonProperty;
//import org.wss.avm.common.avmvulnerability.DependencyDetails;

import java.io.Serializable;
import java.text.DecimalFormat;
import java.util.HashMap;
import java.util.Map;

public class ThreadFixVulnerabilityAlertResultModel  implements Serializable {

    private static final long serialVersionUID = -7943294743570953958L;
    /* --- Members --- */

    @JsonProperty("id")
    private String id;
    @JsonProperty("nativeId")
    private String nativeId;
    @JsonProperty("severity")
    private String severity;
    @JsonProperty("nativeSeverity")
    private String nativeSeverity;
    @JsonProperty("cvssScore")
    private double cvssScore;
    @JsonProperty("summary")
    private String summary;
    @JsonProperty("description")
    private String description;
    @JsonProperty("scannerDetail")
    private String scannerDetail;
    @JsonProperty("scannerRecommendation")
    private String scannerRecommendation;
    @JsonProperty("dependencyDetails")
    private DependencyDetailsModel dependencyDetails;
    @JsonProperty("tags")
    private String[] tags;
    @JsonProperty("comments")
    private String[] comments;
    @JsonProperty("statuses")
    private Map<String, Boolean> statuses;
    @JsonProperty("wssIgnoredAlert")
    private boolean wssIgnoredAlert;

    public static String FALSE_POSITIVE = "False Positive";

    public ThreadFixVulnerabilityAlertResultModel() {
        statuses = new HashMap<>();
    }

    public String getId() {
        return id;
    }

    public void setId(String id) {
        this.id = id;
    }

    public String getNativeId() {
        return nativeId;
    }

    public void setNativeId(String nativeId) {
        this.nativeId = nativeId;
    }

    public String getSeverity() {
        return severity;
    }

    public void setSeverity(String severity) {
        this.severity = severity;
    }

    public String getNativeSeverity() {
        return nativeSeverity;
    }

    public void setNativeSeverity(String nativeSeverity) {
        this.nativeSeverity = nativeSeverity;
    }

    public double getCvssScore() {
        return cvssScore;
    }

    public void setCvssScore(double cvssScore) {
        this.cvssScore = cvssScore;
    }

    public String getSummary() {
        return summary;
    }

    public void setSummary(String summary) {
        this.summary = summary;
    }

    public String getDescription() {
        return description;
    }

    public void setDescription(String description) {
        this.description = description;
    }

    public String getScannerDetail() {
        return scannerDetail;
    }

    public void setScannerDetail(String scannerDetail) {
        this.scannerDetail = scannerDetail;
    }

    public String getScannerRecommendation() {
        return scannerRecommendation;
    }

    public void setScannerRecommendation(String scannerRecommendation) {
        this.scannerRecommendation = scannerRecommendation;
    }

    public DependencyDetailsModel getDependencyDetails() {
        return dependencyDetails;
    }

    public void setDependencyDetails(DependencyDetailsModel dependencyDetails) {
        this.dependencyDetails = dependencyDetails;
    }

    public String[] getTags() {
        return tags;
    }

    public void setTags(String[] tags) {
        this.tags = tags;
    }

    public String[] getComments() {
        return comments;
    }

    public void setComments(String[] comments) {
        this.comments = comments;
    }

    public boolean isFalsePositive() {
        if (statuses.containsKey(FALSE_POSITIVE)) {
            return statuses.get(FALSE_POSITIVE);
        }
        return false;
    }

    public void setFalsePositive(boolean falsePositive) {
        statuses.put(FALSE_POSITIVE, falsePositive);
    }

    public boolean isWssIgnoredAlert() {
        return wssIgnoredAlert;
    }

    public void setWssIgnoredAlert(boolean wssIgnoredAlert) {
        this.wssIgnoredAlert = wssIgnoredAlert;
    }

    @Override
    public boolean equals(Object o) {
        // If the object is compared with itself then return true
        if (o == this) {
            return true;
        }
        /* Check if o is an instance of ThreadFixVulnerabilityAlertResultModel or not
          "null instanceof [type]" also returns false */
        if (!(o instanceof ThreadFixVulnerabilityAlertResultModel)) {
            return false;
        }
        ThreadFixVulnerabilityAlertResultModel ref = (ThreadFixVulnerabilityAlertResultModel) o;
        // Compare the data based on the uniqueId and return accordingly
        return this.nativeId.equals(ref.nativeId);
    }
}

